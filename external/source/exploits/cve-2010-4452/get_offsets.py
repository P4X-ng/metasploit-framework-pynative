#!/usr/bin/env python3
"""
Extract offsets from compiled exploit binary
"""

import sys


def main():
    if len(sys.argv) < 2:
        print("Usage: get_offsets.py <file>", file=sys.stderr)
        sys.exit(1)
    
    try:
        with open(sys.argv[1], 'rb') as fd:
            dat = fd.read()
    except IOError as e:
        print(f"Error reading file: {e}", file=sys.stderr)
        sys.exit(1)
    
    if dat:
        config_marker = b"\x00\x08CONFIGZZ"
        cn_marker = b"\x00\x07AppletX"
        
        config_idx = dat.find(config_marker)
        cn_idx = dat.find(cn_marker)
        
        if config_idx != -1:
            print(f"config_off = 0x{config_idx:x}")
        else:
            print("config_off not found")
        
        if cn_idx != -1:
            print(f"cn_off = 0x{cn_idx:x}")
        else:
            print("cn_off not found")
    else:
        print("No data?!")


if __name__ == "__main__":
    main()
